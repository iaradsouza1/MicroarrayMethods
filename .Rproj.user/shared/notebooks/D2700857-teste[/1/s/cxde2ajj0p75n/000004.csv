"0","pca_prop <- function(eset) {"
"0","  data_exprs <- as.data.frame(na.omit(exprs(eset)))"
"0","  tdata_exprs <- t(data_exprs)"
"0","  importance <- data.frame(t(summary(prcomp(tdata_exprs))$importance), stringsAsFactors = F)"
"0","  colnames(importance) <- c(""sd"", ""var_prop"", ""cum_prop"")"
"0","  importance$pc <- factor(rownames(importance), levels = rownames(importance))"
"0","  importance[,2:3] <- sapply(importance[,2:3], function(x) {x * 100})"
"0","  "
"0","  ggplot(importance, aes(x = pc, y = var_prop)) +"
"0","    geom_bar(stat = ""identity"", fill = ""coral"") +"
"0","    geom_line(aes(y = cum_prop, group = 1), lty = 2, show.legend = T) + "
"0","    scale_y_continuous(limits = c(0,100), breaks = seq(0,100,10)) +"
"0","    labs(title = ""Principal components proportions"", x = ""PC"", y = ""Variation proportion (%)"") +"
"0","    theme_bw() +"
"0","    theme(axis.text.x = element_text(vjust = 0.5, angle = 90))"
"0","  "
"0","}"
"0","pca_prop(eset)"
