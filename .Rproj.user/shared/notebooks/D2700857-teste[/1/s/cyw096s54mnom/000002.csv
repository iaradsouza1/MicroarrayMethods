"0","hk_plot <- function(eset, actin, gapdh) {"
"0","  exp_gapdh <- exprs(eset)[which(fData(eset)$symbol %in% gapdh)[1],]"
"0","  exp_actin <- exprs(eset)[which(fData(eset)$symbol %in% actin)[1],]"
"0","  exp_df <- data.frame(samples = names(exp_actin),"
"0","                       exp_actin, exp_gapdh, row.names = NULL, stringsAsFactors = F)"
"0","  if (grepl("".CEL.gz"", exp_df$samples[1])) {"
"0","    exp_df$samples <- gsub("".CEL.gz"", """", exp_df$samples)"
"0","  }"
"0","  exp_df$samples <- factor(exp_df$samples, levels = exp_df$samples)"
"0","  lim  <- range(c(range(exp_actin), range(exp_gapdh)))"
"0","  lim <- lim + c(-0.5, 0.5)"
"0","  ggplot(exp_df) +"
"0","    geom_line(aes(x = samples, y = exp_actin, group = 1, col = ""Actin""), lwd = 1) +"
"0","    geom_point(aes(x = samples, y = exp_actin, group = 1), col = ""blue"") +"
"0","    geom_line(aes(x = samples, y = exp_gapdh, group = 2, col = ""GAPDH""), lwd = 1) +"
"0","    geom_point(aes(x = samples, y = exp_gapdh, group = 2), col = ""red"") +"
"0","    scale_y_continuous(limits = lim) +"
"0","    scale_color_manual(values = c(""Actin"" = ""blue"", ""GAPDH"" = ""red"")) +"
"0","    labs(title = ""Housekeeping genes expression levels"","
"0","         x = ""Samples"", y = ""log2-normalized expression level"", col = """") +"
"0","    theme_bw() +"
"0","    theme(axis.text.x = element_text(angle = 90, vjust = 0.5))"
"0","}"
"0","gapdh <- ""GAPC"""
"0","actin <- ""ANX1"""
"0","hk_plot(eset, actin = actin, gapdh = gapdh)"
